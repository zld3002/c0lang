#!/bin/sh
#
# generate build id (revision and date) as SML code
#
# William Lovas, 08-27-2010
#

#REV=`git rev-list --count master`
REV=`date +"%Y%m"`
DATE=`date`
HOST=`hostname`

# could probably stand to check $REV for M (local repo has modifications)
# or : (repo is mixed -- several different revisions present) -- these
# should never be true on Andrew, though

cat <<EOF
(******************************************************************)
(* auto-generated by compiler/bin/buildid -- do not edit by hand! *)
(******************************************************************)

structure BuildId =
struct

val revision = "$REV"
val date = "$DATE"
val hostname = "$HOSTNAME"

end
EOF
